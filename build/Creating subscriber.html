



<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Creating a Subscriber Using Github &mdash; ROS Tutorials 0.5.1 documentation</title>
  

  
  
    <link rel="shortcut icon" href="_static/favicon.ico"/>
  

  

  
  
    

  

  
  
    <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  

  
    <link rel="stylesheet" href="_static/clearpath.css" type="text/css" />
  

  
    <link rel="top" title="ROS Tutorials 0.5.1 documentation" href="index.html"/>
        <link rel="next" title="Creating a RQT Dashboard" href="Creating RQT Dashboard.html"/>
        <link rel="prev" title="Creating a Workspace and Publisher" href="Creating publisher.html"/> 

  
  <script src="_static/js/modernizr.min.js"></script>

  <!-- Start of clearpathrobotics Zendesk Widget script -->
<script>/*<![CDATA[​*/window.zEmbed||function(e,t){var n,o,d,i,s,a=[],r=document.createElement("iframe");window.zEmbed=function(){a.push(arguments)},window.zE=window.zE||window.zEmbed,r.src="javascript:false",r.title="",r.role="presentation",(r.frameElement||r).style.cssText="display: none",d=document.getElementsByTagName("script"),d=d[d.length-1],d.parentNode.insertBefore(r,d),i=r.contentWindow,s=i.document;try{o=s}catch(c){n=document.domain,r.src='javascript:var d=document.open();d.domain="'+n+'";void(0);',o=s}o.open()._l=function(){var o=this.createElement("script");n&&(this.domain=n),o.id="js-iframe-async",o.src=e,this.t=+new Date,this.zendeskHost=t,this.zEQueue=a,this.body.appendChild(o)},o.write('<body onload="document._l();">'),o.close()}("https://assets.zendesk.com/embeddable_framework/main.js","clearpathrobotics.zendesk.com");/*​]]>*/</script>
<!-- End of clearpathrobotics Zendesk Widget script -->

<script>
 (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
 (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
 m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
 })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

 ga('create', 'UA-71565737-1', 'auto');
 ga('send', 'pageview');

</script>

</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="index.html" class="icon icon-home"> ROS Tutorials
          
          </a>
          
            
            <a href="http://www.clearpathrobotics.com/">
            <img src="_static/clearpathlogo.png" class="logo" />
          </a>
          
          

          
            
            
              <div class="version">
                0.5.1
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search..." />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
                <ul class="simple">
</ul>
<p class="caption"><span class="caption-text">Beginner</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="Getting Started with Ubuntu.html">ROS 101: Getting Started with Ubuntu</a></li>
<li class="toctree-l1"><a class="reference internal" href="Intro to the Robot Operating System.html">ROS 101: Intro to ROS</a></li>
<li class="toctree-l1"><a class="reference internal" href="Practical Example.html">ROS 101: A Practical Example</a></li>
<li class="toctree-l1"><a class="reference internal" href="Drive a Husky.html">ROS 101: Drive a Husky</a></li>
<li class="toctree-l1"><a class="reference internal" href="Drive a Grizzly.html">ROS 101: Drive a Grizzly</a></li>
</ul>
<p class="caption"><span class="caption-text">Intermediate</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="Creating publisher.html">Creating a Workspace and Publisher</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="">Creating a Subscriber Using Github</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#pulling-from-github">Pulling from GitHub</a></li>
<li class="toctree-l2"><a class="reference internal" href="#writing-the-subscriber">Writing the Subscriber</a></li>
<li class="toctree-l2"><a class="reference internal" href="#putting-it-all-together">Putting it All Together</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="Creating RQT Dashboard.html">Creating a RQT Dashboard</a></li>
<li class="toctree-l1"><a class="reference internal" href="Launch Files.html">Launch Files</a></li>
<li class="toctree-l1"><a class="reference internal" href="Udev Rules.html">Udev Rules</a></li>
<li class="toctree-l1"><a class="reference internal" href="Driving Husky with ROSSerial.html">Driving Husky with ROSSerial</a></li>
<li class="toctree-l1"><a class="reference internal" href="ROS Parameter Server.html">ROS Parameter Server</a></li>
<li class="toctree-l1"><a class="reference internal" href="ROS Navigation Basics.html">ROS Navigation Basics</a></li>
<li class="toctree-l1"><a class="reference internal" href="Converting ROS bag to CSV.html">Converting ROS Bag to CSV</a></li>
</ul>
<p class="caption"><span class="caption-text">Advanced</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="Nodelet Everything.html">Nodelet Everything</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
        <a href="index.html">ROS Tutorials</a>
      </nav>


      
      <div class="wy-nav-content">
        <div class="rst-content">
     
          





<div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="http://support.clearpathrobotics.com">Home</a> &raquo;</li>
      
    <li>Creating a Subscriber Using Github</li>
      <li class="wy-breadcrumbs-aside">
        <div class="roslogo">
      </div>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="creating-a-subscriber-using-github">
<h1>Creating a Subscriber Using Github<a class="headerlink" href="#creating-a-subscriber-using-github" title="Permalink to this headline">¶</a></h1>
<p>We previously learned how to write a publisher node to move Husky randomly. BUT! What good is publishing all these messages if no one is there to read it? In this tutorial we&#8217;ll write a subscriber that reads Husky&#8217;s position from the odom topic, and graph its movements. Instead of just copy-pasting code into a text file, we&#8217;ll pull the required packages from GitHub, a very common practice among developers.</p>
<p>Before we begin, install Git to pull packages from GitHub, and pygame, to provide us with the tools to map out Husky&#8217;s movements:</p>
<div class="highlight-bash"><div class="highlight"><pre>sudo apt-get install git
sudo apt-get install python-pygame
</pre></div>
</div>
<div class="section" id="pulling-from-github">
<h2>Pulling from GitHub<a class="headerlink" href="#pulling-from-github" title="Permalink to this headline">¶</a></h2>
<p>GitHub is a popular tool among developers due to its use of version control - most ROS software has an associated GitHub repository. Users are able to &#8220;pull&#8221; files from the GitHub servers, make changes, then &#8220;push&#8221; these changes back to the server. In this tutorial we will be using GitHub to pull the ROS packages that we&#8217;ll be using.  The first step is to make a new directory to pull the packages:</p>
<div class="highlight-bash"><div class="highlight"><pre>mkdir -p ~/catkin_ws/src/ros101
<span class="nb">cd</span> ~/catkin_ws/src/ros101
git init
</pre></div>
</div>
<p>Since we now know the URL that hosts the repositories, we&#8217;ll easily be able to pull the packages from GitHub. Access the repositories using the following command:</p>
<div class="highlight-bash"><div class="highlight"><pre>git pull https://github.com/mcoteCPR/ROS101.git
</pre></div>
</div>
<p>That&#8217;s it! You should see an src and launch folder, as well as a <strong>CMakelist.txt</strong> and <strong>package.xml</strong> in your ros101 folder. You now have the package <strong>ros101</strong> which includes the nodes <strong>random_driver.cpp</strong> and <strong>odom_graph.py</strong>.</p>
</div>
<div class="section" id="writing-the-subscriber">
<h2>Writing the Subscriber<a class="headerlink" href="#writing-the-subscriber" title="Permalink to this headline">¶</a></h2>
<p>We&#8217;ve already gone through the random_driver C++ code in the last tutorial, so this time we&#8217;ll go over the python code for <strong>odom_graph.py</strong>. This node uses the Pygame library to track Husky&#8217;s movement. Pygame is a set of modules intended to create video games in python; however, we&#8217;ll focus on the ROS portion of this code. More information on Pygame can be found <a class="reference external" href="http://www.pygame.org/">on their website</a> . The code for the <strong>odom_graph</strong> node can be found at:</p>
<div class="highlight-bash"><div class="highlight"><pre>gedit ~/catkin_ws/src/ros101/src/odom_graph.py
</pre></div>
</div>
<p>Let&#8217;s take a look at this code line by line:</p>
<div class="highlight-bash"><div class="highlight"><pre>import rospy
from nav_msgs.msg import Odometry
</pre></div>
</div>
<p>Much like the C++ publisher code, this includes the rospy library and imports the Odometry message type from <strong>nav_msgs.msg</strong>. To learn more about a specific message type, you can visit <a class="reference external" href="http://docs.ros.org">http://docs.ros.org</a> to see it&#8217;s definition, for example, we are using <a class="reference external" href="http://docs.ros.org/api/nav_msgs/html/msg/Odometry.html">http://docs.ros.org/api/nav_msgs/html/msg/Odometry.html</a> . The next block of code imports the pygame libraries and sets up the initial conditions for our display.</p>
<div class="highlight-bash"><div class="highlight"><pre>def odomCB<span class="o">(</span>msg<span class="o">)</span>
</pre></div>
</div>
<p>This is the odometry call back function, which is called every time our subscriber receives a message. The content of this function simply draws a line on our display between the last coordinates read from the odometry position message. This function will continually be called in our main loop.</p>
<div class="highlight-bash"><div class="highlight"><pre>def listener<span class="o">()</span>:
</pre></div>
</div>
<p>The following line starts the ROS node, <strong>anonymous=True</strong> means multiples of the same node can run at the same time:</p>
<div class="highlight-bash"><div class="highlight"><pre>rospy.init_node<span class="o">(</span><span class="s1">&#39;odom_graph&#39;</span>, <span class="nv">anonymous</span><span class="o">=</span>True<span class="o">)</span>
</pre></div>
</div>
<p>Subscriber sets up the node to read messages from the &#8220;odom&#8221; topic, which are of the type Odometry, and calls the <strong>odomCB</strong> functions when it receives a message:</p>
<div class="highlight-bash"><div class="highlight"><pre>rospy.Subscriber<span class="o">(</span><span class="s2">&quot;odom&quot;</span>, Odometry, odomCB<span class="o">)</span>
</pre></div>
</div>
<p>The last line of this function keeps the node active until it&#8217;s shut down:</p>
<div class="highlight-bash"><div class="highlight"><pre>rospy.spin<span class="o">()</span>
</pre></div>
</div>
</div>
<div class="section" id="putting-it-all-together">
<h2>Putting it All Together<a class="headerlink" href="#putting-it-all-together" title="Permalink to this headline">¶</a></h2>
<p>Now it&#8217;s time to test it out! Go ahead and close the <strong>odom_graph.py</strong> file and build your workspace using the catkin_make function in your workspace directory.</p>
<div class="highlight-bash"><div class="highlight"><pre><span class="nb">cd</span> ~/catkin_ws
catkin_make
</pre></div>
</div>
<p>The next step is to launch our Husky simulation to start up ROS and all the Husky related nodes.</p>
<div class="highlight-bash"><div class="highlight"><pre>roslaunch husky_gazebo husky_emepty_world.launch
</pre></div>
</div>
<p>In this tutorial we have provided a launch file that will start the random_driver and <strong>odom_graph</strong> node. The launch file is located in <strong>~/ros101/src/launch</strong> and is called <strong>odom_graph_test.launch</strong>. If you want to learn more about launch files, check out our launch file article on our support knowledge base. We will now source our workspace and launch both nodes with the launch file in a new terminal window.</p>
<div class="highlight-bash"><div class="highlight"><pre><span class="nb">source</span> ~/catkin_ws/devel/setup.bash
roslaunch ros101 odom_graph_test.launch
</pre></div>
</div>
<a class="reference internal image-reference" href="_images/ROS101-GitHub1.png"><img alt="_images/ROS101-GitHub1.png" src="_images/ROS101-GitHub1.png" style="width: 515.0px; height: 386.0px;" /></a>
<p>ROS101 GitHub1 There you have it! Our subscriber is now listening to messages on the odom topic, and graphing out Husky&#8217;s path.</p>
</div>
</div>


           </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="Creating RQT Dashboard.html" class="btn btn-neutral float-right" title="Creating a RQT Dashboard" accesskey="n">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="Creating publisher.html" class="btn btn-neutral" title="Creating a Workspace and Publisher" accesskey="p"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2015, Clearpath Robotics.

    </p>
  </div> 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'./',
            VERSION:'0.5.1',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true
        };
    </script>
      <script type="text/javascript" src="_static/jquery.js"></script>
      <script type="text/javascript" src="_static/underscore.js"></script>
      <script type="text/javascript" src="_static/doctools.js"></script>

  

  
  
    <script type="text/javascript" src="_static/js/theme.js"></script>
  

  
  
  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.StickyNav.enable();
      });
  </script>
   

</body>
</html>